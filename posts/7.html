---
title: "Random Rom"
date: 2020-10-24
---
{% set html %}
<blockquote>Loading quote...</blockquote>

<button>More Ron</button>


{% endset %}

<div class="htmlBox">
  {{ html | safe }}
</div>

{% highlight "html" %}
{{ html | safe }}
{% endhighlight %}

{% set js %}
<script async>

  // Variables
  let ronQuote = document.querySelector('blockquote');
  let ronButton = document.querySelector('button');

  // Methods
  function callRon() {
    fetch('https://ron-swanson-quotes.herokuapp.com/v2/quotes').then(function (response) {
      if (response.ok) {
        return response.json();
      } else {
        return Promise.reject(response);
      }
    }).then(function (data) {
      let tempDiv = document.querySelector("#errorState");
      if (tempDiv) tempDiv.remove();
      ronQuote.innerHTML = `
      <p>${data[0]}</p>
      <footer>â€” Ron Swanson</footer>`;
    }).
      catch(function (err) {
        console.warn("oh no something went wrong", err);
        let tempDiv = document.querySelector("#errorState");
        if (!tempDiv) {
          tempDiv = document.createElement('p');
          tempDiv.setAttribute("id", "errorState");
          tempDiv.style.color = "red";
          tempDiv.textContent = "There was an error getting a quote, please try again."
          ronButton.after(tempDiv);
        }
      })
  };
  function handleInput(event) {
    if (event.target !== ronButton) return;
    callRon();
  };

  // Listeners and inits
  callRon();
  document.addEventListener('click', handleInput);

</script>
{% endset %}

{% highlight "html" %}
{{ js | safe }}
{% endhighlight %}

<div class="htmlBox">
  {% markdown '/notes/7.md' %}
</div>

{{ js | safe }}