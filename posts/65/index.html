<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Places</title>
    <meta name="description" content="Exercises on Vanilla JS Academy 2020">
    <link rel="stylesheet" href="/vanillajsacademy/css/index.css">
    <link rel="stylesheet" href="/vanillajsacademy/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/vanillajsacademy/feed/feed.xml" type="application/atom+xml" title="miguelslp - Vanilla JS">
    <link rel="alternate" href="/vanillajsacademy/feed/feed.json" type="application/json" title="miguelslp - Vanilla JS">
  </head>
  <body>
    <header>
      <h1 class="home">
        <a href="/vanillajsacademy/">miguelslp - Vanilla JS</a>
      </h1>
      
    </header>

    <main  class="tmpl-post" >
      <h1>Places</h1>

<div class="grid">
<style>
/**
 * Grid Layout
 */
 @media (min-width: 40em) {
	.place {
		display: grid;
		grid-template-columns: 1fr 2fr;
		grid-template-rows: 1fr;
		grid-column-gap: 2em;
	}
}

/**
 * Responsive Images
 */
img {
	height: auto;
	max-width: 100%;
}
</style>
<!-- Setting the html code -->

<!-- Setting the js code -->


<!-- Rendering the html -->
<div class="htmlBox">
  
<p>Explore cool, quirky places in your own backyard.</p>

<div id="app">Loading...</div>

</div>

<!-- Rendering the html and js as syntax highlight -->
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Explore cool, quirky places in your own backyard.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><br><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Loading...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br> <br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/reefjs@8/dist/reef.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br>  <span class="token comment">// Get place data from the API and update app state</span><br>  <span class="token keyword">var</span> <span class="token function-variable function">getPlaces</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://vanillajsacademy.com/api/places.json'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      app<span class="token punctuation">.</span>data<span class="token punctuation">.</span>places <span class="token operator">=</span> data<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      app<span class="token punctuation">.</span>data<span class="token punctuation">.</span>places <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// The app component</span><br>  <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Reef</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function-variable function">template</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <br>      <span class="token comment">// If there are places, render them</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>places <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>places<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token function">getPlacesHTML</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token comment">// Otherwise, show an error</span><br>      <span class="token keyword">return</span> <span class="token function">getNoPlacesHTML</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// Get the message to dispay if there is no palce data</span><br>  <span class="token keyword">var</span> <span class="token function-variable function">getNoPlacesHTML</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;p>&lt;em>Unable to find any places right now. Please try again later. Sorry!&lt;/em>&lt;/p></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// Create HTML for each of the palces from the app data</span><br>  <span class="token keyword">var</span> <span class="token function-variable function">getPlacesHTML</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> props<span class="token punctuation">.</span>places<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">place</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">'&lt;div class="place">'</span> <span class="token operator">+</span><br>				<span class="token string">'&lt;div>'</span> <span class="token operator">+</span><br>					<span class="token string">'&lt;img alt="" src="'</span> <span class="token operator">+</span> place<span class="token punctuation">.</span>img <span class="token operator">+</span> <span class="token string">'">'</span> <span class="token operator">+</span><br>				<span class="token string">'&lt;/div>'</span> <span class="token operator">+</span><br>				<span class="token string">'&lt;div>'</span> <span class="token operator">+</span><br>					<span class="token string">'&lt;h2>'</span> <span class="token operator">+</span> place<span class="token punctuation">.</span>place <span class="token operator">+</span> <span class="token string">'&lt;/h2>'</span> <span class="token operator">+</span><br>					<span class="token string">'&lt;p>'</span> <span class="token operator">+</span> place<span class="token punctuation">.</span>description <span class="token operator">+</span> <span class="token string">'&lt;/p>'</span> <span class="token operator">+</span><br>					<span class="token string">'&lt;p>&lt;em>'</span> <span class="token operator">+</span> place<span class="token punctuation">.</span>location <span class="token operator">+</span> <span class="token string">'&lt;/em>&lt;br>&lt;a href="'</span> <span class="token operator">+</span> place<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">'">'</span> <span class="token operator">+</span> place<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">'&lt;/a>&lt;/p>'</span> <span class="token operator">+</span><br>				<span class="token string">'&lt;/div>'</span> <span class="token operator">+</span><br>      <span class="token string">'&lt;/div>'</span><span class="token punctuation">;</span><br>      <span class="token keyword">return</span> html<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// Inits</span><br>  <span class="token function">getPlaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre>

<!-- Inserting the js as a script -->

<script src="https://cdn.jsdelivr.net/npm/reefjs@8/dist/reef.min.js"></script>
<script>
  // Get place data from the API and update app state
  var getPlaces = function () {
    fetch('https://vanillajsacademy.com/api/places.json').then(function (response) {
      if (response.ok) {
        return response.json();
      }
      return Promise.reject(response);
    }).then(function (data) {
      app.data.places = data;
    }).catch(function (err) {
      console.warn(err);
      app.data.places = null;
    });
  };

  // The app component
  var app = new Reef('#app', {
    data: {},
    template: function (data) {
      
      // If there are places, render them
      if (data.places && data.places.length) {
        return getPlacesHTML(data);
      }

      // Otherwise, show an error
      return getNoPlacesHTML();
    }
  });

  // Get the message to dispay if there is no palce data
  var getNoPlacesHTML = function () {
    return `<p><em>Unable to find any places right now. Please try again later. Sorry!</em></p>`;
  };

  // Create HTML for each of the palces from the app data
  var getPlacesHTML = function (props) {
    return props.places.map(function (place) {
      var html = '<div class="place">' +
				'<div>' +
					'<img alt="" src="' + place.img + '">' +
				'</div>' +
				'<div>' +
					'<h2>' + place.place + '</h2>' +
					'<p>' + place.description + '</p>' +
					'<p><em>' + place.location + '</em><br><a href="' + place.url + '">' + place.url + '</a></p>' +
				'</div>' +
      '</div>';
      return html;
    }).join('');
  };

  // Inits
  getPlaces();
</script>

</div>

    </main>

    <footer>
      ©
      Miguel Pinto
      2021
    </footer>

    <!-- Current page: /vanillajsacademy/posts/65/ -->

    
    
  </body>
</html>